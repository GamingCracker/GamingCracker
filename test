local plr = game.Players.LocalPlayer
local char = plr.Character
local backpack = plr:WaitForChild("Backpack")
local lastPos = char.PrimaryPart.CFrame
local autoFarmEnabled = false
local range = 50 -- range in studs

local function fastAttack()
    local tool1 = backpack:FindFirstChildOfClass("Tool") or char:FindFirstChildOfClass("Tool")
    local tool2 = backpack:FindFirstChildOfClass("Tool", 2) or char:FindFirstChildOfClass("Tool", 2)
    if tool1 then
        tool1.Parent = char
        tool1:Activate()
    end
    if tool2 then
        tool2.Parent = char
        tool2:Activate()
    end
end

local function autoFarm()
    while autoFarmEnabled do
        pcall(function()
            for i, v in pairs(workspace.ReplicatedChunks:GetDescendants()) do
                if v.Name == "Clown Guard" then
                    local enemy = v
                    lastPos = enemy.PrimaryPart.CFrame
                    repeat
                        task.wait()
                        char:SetPrimaryPartCFrame(enemy.PrimaryPart.CFrame * CFrame.new(0,-10,0))
                        fastAttack()
                    until enemy.Humanoid.Health <=0 or not enemy or not autoFarmEnabled
                end
            end
            char:SetPrimaryPartCFrame(lastPos * CFrame.new(0,10,0))
        end)
        task.wait()
    end
end

local screenGui = Instance.new("ScreenGui")
screenGui.Parent = game.CoreGui

local textButton = Instance.new("TextButton")
textButton.Parent = screenGui
textButton.Size = UDim2.new(0, 100, 0, 50)
textButton.Position = UDim2.new(0.5, -50, 0.5, -25)
textButton.Text = "Toggle Auto Farm"

textButton.MouseButton1Click:Connect(function()
    autoFarmEnabled = not autoFarmEnabled
    if autoFarmEnabled then
        textButton.Text = "Auto Farm: ON"
        plr.Character:SetPrimaryPartCFrame(game.ReplicatedStorage.ViewportNPCs.Titan.PrimaryPart.CFrame * CFrame.new(0,10,0))
        autoFarm()
    else
        textButton.Text = "Auto Farm: OFF"
    end
end)
